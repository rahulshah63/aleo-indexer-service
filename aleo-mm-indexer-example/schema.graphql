
# --- Base Types ---
scalar BigInt  # Represents u64 and u128 Aleo types
scalar DateTime # Represents timestamps
scalar JSON    # Represents complex Aleo records, arrays, or generic JSON data

type Query {
    transactions(
        limit: Int = 10,
        offset: Int = 0,
        programId: String,
        functionName: String
    ): [Transaction!]
    transaction(id: String!): Transaction
    market_reserves_historicals(limit: Int = 10, offset: Int = 0): [Market_reserves_historicals!]
    market_reserves_historical(id: Int!): Market_reserves_historicals
    reserve_data_mapping(limit: Int = 10, offset: Int = 0): [Reserve_data_mapping!]
    reserve_config_mapping(limit: Int = 10, offset: Int = 0): [Reserve_config_mapping!]
}


# --- Base Schemas (Always Included) ---

type IndexerState {
    programName: String!
    lastIndexedBlock: Int!
    lastUpdated: DateTime!
}

type Transaction {
    id: String!
    programId: String!
    functionName: String!
    blockHeight: Int!
    timestamp: DateTime!
    raw: JSON # Store the raw transaction object
}

# --- Auto-Generated Schemas from indexer.config.ts ---

type ReserveData {
  last_update_block_height: Int
  liquidity_rate: BigInt
  borrow_rate: BigInt
  liquidity_cumulative_index: BigInt
  borrow_cumulative_index: BigInt
}

type ReserveConfig {
  token_id: String
  decimals: Int
  base_LTV_as_collateral: BigInt
  liquidation_threshold: BigInt
  liquidation_bonus: BigInt
  optimal_utilization_rate: BigInt
  base_borrow_rate: BigInt
  borrow_threshold: BigInt
  is_freezed: Boolean
  is_active: Boolean
}

type Market_reserves_historicals {
  id: Int!
  transaction: Transaction!
  token_id_cipher: String
  liquidity_cumulative_index_cipher: String
  borrow_cumulative_index_cipher: String
  base_LTV_as_collateral_cipher: String
  liquidation_threshold_cipher: String
  liquidation_bonus_cipher: String
  decimals_cipher: String
  optimal_utilization_rate_cipher: String
  base_borrow_rate_cipher: String
  is_freezed_cipher: String
  is_active_cipher: String
  borrow_threshold_cipher: String
  user_address: String
  last_update_block_height: Int
  liquidity_rate: BigInt
  borrow_rate: BigInt
  liquidity_cumulative_index: BigInt
  borrow_cumulative_index: BigInt
  token_id: String
  decimals: Int
  base_LTV_as_collateral: BigInt
  liquidation_threshold: BigInt
  liquidation_bonus: BigInt
  optimal_utilization_rate: BigInt
  base_borrow_rate: BigInt
  borrow_threshold: BigInt
  is_freezed: Boolean
  is_active: Boolean
}

type Reserve_data_mapping {
  key: String!
  value: ReserveData!
  lastUpdatedBlock: Int!
}

type Reserve_config_mapping {
  key: String!
  value: ReserveConfig!
  lastUpdatedBlock: Int!
}

